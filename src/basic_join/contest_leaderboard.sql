SELECT 
  M.HACKER_ID, H.NAME, SUM(M.SCORE) 
AS 
  TOTAL_SCORE 
FROM
  (
  SELECT 
    HACKER_ID, CHALLENGE_ID, MAX(SCORE) 
  AS 
    SCORE 
  FROM 
    SUBMISSIONS 
  GROUP BY 
    HACKER_ID, CHALLENGE_ID
  ) 
AS 
  M
JOIN 
  HACKERS 
AS 
  H 
ON 
  M.HACKER_ID = H.HACKER_ID 
GROUP BY 
  M.HACKER_ID, H.NAME
HAVING 
  TOTAL_SCORE > 0
ORDER BY 
  TOTAL_SCORE DESC, 
  M.HACKER_ID;
